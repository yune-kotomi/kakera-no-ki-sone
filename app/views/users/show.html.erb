<%
  if params[:archived]
    @title = "保存記録"
  else
    @title = "文書"
  end
  @title = "#{@title}: #{@user.nickname}" unless @login_user == @user
 %>

<div class="row documents">
  <% @documents.each do |document| %>
    <div class="col s12 m4">
      <div class="card small">
        <div class="card-content">
          <%
            if @user == @login_user
              link = edit_document_path(document)
            else
              link = document
            end
          %>
          <%= link_to link do %>
            <span class="card-title grey-text text-darken-4"><%= document.title %></span>
            <p><%= document.description %></p>
          <% end %>
        </div>

        <% if @user == @login_user %>
          <div class="card-action">
            <%= link_to document,
              :method => :delete,
              :data => {:confirm => '本当に削除してよろしいですか?'},
              :class => 'waves-effect btn-flat' do %>
              <i class="mdi-action-delete"></i>
            <% end %>

            <%= form_for(document) do |f| %>
              <%= f.button :class => 'waves-effect btn-flat' do %>
                <% if document.archived %>
                  <i class="mdi-content-archive-invert"></i>
                <% else %>
                  <i class="mdi-content-archive"></i>
                <% end %>
              <% end %>
              <% document.archived = !document.archived %>
              <%= f.hidden_field :archived %>
            <% end %>
          </div>
        <% end %>
      </div>
    </div>
  <% end %>
</div>

<%= paginate(@documents) %>

<div class="fixed-action-btn" style="bottom: 24px; right: 34px;">
  <%= form_for @user.documents.build do %>
    <button class="waves-effect waves-light btn-floating btn-large red">
      <i class="large mdi-content-add"></i>
    </button>
  <% end %>
</div>
